Синтаксис компиляции SCRIPT.DAT

romiq.kh@gmail.com
v0.3 2014-06-03

<u>Синтаксис файла</u>

Команды указываются построчно, разбиение одной команды на несколько строк не 
допускается. Часть строки после символа '#' считается комментарием.

Обозначения:
 * \<обязательные параметры\>
 * [необязательные]
 * "строка"

В файле могут быть определены следующие записи:

 * OBJ - объекты, попадают в первую половину SCRIPT.DAT
 * SCENE - сцены, попадают во вторую половину SCRIPT.DAT
 * RES - ресурсы, попадают в RESOURCE.QRC
 
<u>OBJ</u>

OBJ \<идентификатор объекта\> \<номер 0..0xffff\> "\<Имя\>"
  [обработчики событий - ON]
ENDOBJ

<u>SCENE</u>

SCENE \<идентификатор сцены\> \<номер 0..0xffff\> "\<Имя\>"
  [обработчики событий - ON]
  [ссылки на другие объекты - REF]
ENDSCENE

<u>RES</u>

RES \<идентификатор ресурса\> \<номер 0..0xffff\> "\<путь\>"

<u>ON</u>

Обработчик события. Вызывается при применении на объекте операции.
При загрузке скрипта ко всем объектам и сценам применяется операция TOTALINIT.

ON \<операция\>
ON \<операция\> [\<статус 0..0xff\> \<идентификатор объекта 0..0xffff\>]
ON \<операция\> [\<статус 0..0xff\> THIS]
  [операции]
ENDON

<u>REF</u>

REF \<ссылка на объект\> [\<аргумент 1\> [\<аргумент 2\> [\<аргумент 3\> [\<аргумент 4\> [\<аргумент 5\>]]]]]

Отсутствующие аргументы будут заменены на -1 (0xffffffff).
 
<u>ZEROREF</u>

Используется если запись в backgrnd.bg необходима, но ни один из объектов не 
добавлен к сцене. Если у сцены уже были указаны REF использвание этого операнда 
невозможно.

<u>операции</u>

\<код операции\> \<ссылка на объект\> [\<аргумент 1\> [\<аргумент 2\> [\<аргумент 3\>]]]

Ссылка на объект может быть указана на текущий объекта с помощью слова THIS.

Отсутствующие аргументы будут заменены на -1 (0xffff).

Операции:

 * USE
 * SETPOS
 * GOTO
 * LOOK
 * SAY
 * TAKE
 * WALK
 * TALK
 * END
 * SET
 * SHOW
 * HIDE
 * DIALOG
 * ZBUFFER
 * TOTALINIT
 * ANIMATE
 * STATUS
 * ADDINV
 * DELINV
 * STOP
 * CURSOR
 * OBJECTUSE
 * ACTIVE
 * SAID
 * SETSEQ
 * ENDSEQ
 * CHECK
 * IF
 * DESCRIPTION
 * HALF
 * WALKTO
 * WALKVICH
 * INITBG
 * USERMSG
 * SYSTEM
 * SETZBUFFER
 * CONTINUE
 * MAP
 * PASSIVE
 * NOMAP
 * SETINV
 * BGSFX
 * MUSIC
 * IMAGE
 * STAND
 * ON
 * OFF
 * PLAY
 * LEAVEBG
 * SHAKE
 * SP
 * RANDOM
 * JUMP
 * JUMPVICH
 * PART
 * CHAPTER
 * AVI
 * TOMAP
 * число 0..0xffff

